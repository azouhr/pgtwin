# PostgreSQL HA Cluster Configuration
# Managed by pgtwin resource agent
#
# This file contains the minimal required settings for PostgreSQL HA with pgtwin.
# Copy this file to /var/lib/pgsql/data/postgresql.custom.conf on the primary node.

# Replication settings
listen_addresses = '*'
port = 5432
max_connections = 100

# WAL settings for replication
wal_level = replica
max_wal_senders = 5
max_replication_slots = 5
hot_standby = on
wal_log_hints = on

# Synchronous replication (will be managed dynamically by pgtwin notify)
# ⚠️  IMPORTANT: Keep this empty ('') for initial cluster setup!
# This allows the first node to start and promote successfully.
# pgtwin will enable sync replication automatically based on rep_mode
# parameter once both nodes are online.
#
# Safety (v1.6.14): If a single node boots with sync enabled, pgtwin
# will refuse to start it as primary (prevents data loss in double-failure
# scenarios where the wrong node booted first).
synchronous_standby_names = ''

# Archive mode (optional but recommended)
archive_mode = on
archive_command = '/bin/true'

# CRITICAL: MUST be off for Pacemaker management
# Setting this to 'on' will cause split-brain scenarios
restart_after_crash = off
